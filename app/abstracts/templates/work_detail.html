{% extends "base.html" %}

{% block content %}

<h1>{{ work.pref_title }}</h1>

<p><a href="{% url 'conference_detail' work.conference.pk %}">{{ work.conference.year }} - {{ work.conference.venue }}</a></p>

<h2>All Authors</h2>
<ol>
{% for author in work_authors %}
  <li><a href="{% url 'author_detail' author.pk %}">{{ author.pref_name }}</a></li>
{% endfor %}
</ol>

<h2>Versions</h2>

<div class="accordion" id="workVersionAccordion">
  {% for version in work_versions %}

  <div class="card">
    <div class="card-header" id="heading{{ forloop.counter }}">
      <h5 class="mb-0">
        <span class="badge badge-secondary">{{ version.conference_type }}</span>
        <button class="btn btn-link{% if forloop.first is not True %} collapsed{% endif %}" type="button" data-toggle="collapse" data-target="#collapse{{ forloop.counter }}" aria-expanded="{{ forloop.first | lower }}"
          aria-controls="collapse{{ forloop.counter }}">
        {{ version.title }}
        </button>
        {% if version.state == "ac" %}
        <span class="badge badge-primary">Accepted</span>
        {% else %}
        <span class="badge badge-secondary">Submitted</span>
        {% endif %}
      </h5>
    </div>

    <div id="collapse{{ forloop.counter }}" class="collapse{% if forloop.first %} show{% endif %}" aria-labelledby="heading{{ forloop.counter }}" data-parent="#workVersionAccordion">
      <div class="card-body">
        <h4>Version authors:</h4>
        <ul>
          {% for author in version.authors.all %}
          <li><a href="{% url 'author_detail' author.pk %}">{{ author.pref_name }}</a></li>
          {% endfor %}
        </ul>

        <h4>Abstract</h4>

        {% if version.full_text %}
          <p>{{ version.full_text }}</p>
        {% else %}
          <p>No full text available for this version.</p>
        {% endif %}

        <h4>Tags</h4>

        <h5>Keywords</h5>
        {% if version.keywords.all %}
        <ul>
          {% for keyword in version.keywords.all %}
          <li>{{ keyword.title }}</li>
          {% endfor %}
        </ul>
        {% else %}
        <p>This version has no associated keywords</p>
        {% endif %}

        <h5>Language</h5>
        {% if version.languages.all %}
        <ul>
          {% for language in version.languages.all %}
          <li>{{ language.title }}</li>
          {% endfor %}
        </ul>
        {% else %}
        <p>This version has no associated languages</p>
        {% endif %}

        <h5>Topics</h5>
        {% if version.topics.all %}
        <ul>
          {% for topic in version.topics.all %}
          <li>{{ topic.title }}</li>
          {% endfor %}
        </ul>
        {% else %}
        <p>This version has no associated topics</p>
        {% endif %}

        <h5>Disciplines</h5>
        {% if version.disciplines.all %}
        <ul>
          {% for discipline in version.disciplines.all %}
          <li>{{ discipline.title }}</li>
          {% endfor %}
        </ul>
        {% else %}
        <p>This version has no associated disciplines</p>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

{% endblock %}
