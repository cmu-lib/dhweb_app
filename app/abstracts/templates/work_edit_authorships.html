{% extends "base.html" %}

{% block header_title %}Editing abstract ID {{ work.pk }}{% endblock %}

{% block content %}

{% if work.state == "su" and not user.is_authenticated %}
<div class="alert alert-warning">You must <a href="/admin/login/?next=/works/{{ work.pk }}">log in</a> to view submitted
  versions.</div>
{% else %}

<div class="card m-2">
  <div class="card-header">
    <nav>
      <ul class="nav nav-pills">
        <li class="nav-item">
          <a class="nav-link" href="{% url 'work_edit' work.pk %}">Core Features</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="{% url 'work_edit_authorship' work.pk %}">Authorships</a>
        </li>
      </ul>
    </nav>
  </div>
  <div class="card-body">
    {% load static %}
    {% load crispy_forms_tags %}
    <form method="post">
      {% csrf_token %}
      {{ authorships_form.media }}
      {{ authorships_form.management_form }}
      <ul class="list-group list-group">
        {% for form in authorships_form %}
        <li class="list-group-item">
          <h2>Author {{ form.authorship_order }}</h2>
          <div class="row">
            <div class="col">
              {{ form.author|as_crispy_field }}
              {{ form.first_name|as_crispy_field }}
              {{ form.last_name|as_crispy_field }}
            </div>
            <div class="col">
              {{ form.affiliation|as_crispy_field }}
              {{ form.department|as_crispy_field }}
              {{ form.institution|as_crispy_field }}
              {{ form.genders|as_crispy_field }}
            </div>
          </div>
        </li>
        {% endfor %}
      </ul>
      <div class="form-group my-4">
        <button type="submit" class="btn btn-primary mb-2">Submit</button>
        <a class="btn btn-secondary mb-2" href="{% url 'work_detail' work.pk %}" role="button">Cancel</a>
      </div>
    </form>
  </div>
</div>

{% endif %}

{% endblock %}
